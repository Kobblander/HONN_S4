@(driver: is.ru.honn.ruber.domain.Driver, product: is.ru.honn.ruber.domain.Product)

@main(title = driver.getFirstName()) {

	<h2>@driver.getFirstName() @driver.getLastName()</h2>

	<a href="@routes.DriverController.getDriverReviews(driver.getId)">View reviews</a>

	<h3>Car: @product.getDescription()</h3>
	<img id="carImage" src="@product.getImage()" alt="Car">

	<button id="fadeButton">Add review</button>
	<div id="addReview" style="display: none">
		<input id="commentInput" type="text" value="comment">
		<input id="ratingInput" type="number" max="5" min="0" value="rating">
		<button id="submitReview">Submit</button>
	</div>
	<div id="reviews"></div>

	<script>
		$(document).ready(function() {
			console.log("Hello!");
			$.get("@routes.DriverController.getDriverReviews(driver.getId())",function(data, status) {
				data.forEach(function(review) {
					var innerDiv = $("<div class='reviewDiv'></div>");
					innerDiv.append("<p>" + review.comment + "</p>");
					innerDiv.append("<p>" + review.rating + "</p>");
					$("#reviews").append(innerDiv);
				});
			});

			$("#fadeButton" ).click(function() {
				$("#addReview" ).fadeToggle("slow");
			})

		});

		$('#submitReview').click( function() {
			var review = {"comment":$("#commentInput" ).val(), "rating":$("#ratingInput" ).val()};
			//var toJ = JSON.parse(review);
			$.ajax({
				url: '@routes.DriverController.review(driver.getId())',
				type: 'post',
				dataType: 'json',
				data: {"comment": $("#commentInput" ).val(), "rating": $("#ratingInput" ).val()},
				success: function(data) {
						console.log(data);
					},
				error: function(data) {
					console.log(data);
				}
			});
		});
	</script>

}
